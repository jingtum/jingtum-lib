var jlib = require('./jingtum-lib');
var Remote = jlib.Remote;
var utils = jlib.utils;
var remote = new Remote({server: 'ws://101.200.230.74:5020'}); //多重签名


// remote.connect(function(err, result) {
//     if (err) {
//         return console.log('err******', err);
//     }

    var root = {
        'secret': 'snoPBjXtMeMyMHUVTgbuqAfg1SUTb',//合约根账号
        'address': 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh'
    };

    var a1 = {address: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb', secret: 'ssRi4kAuYJvsdiaVWCn5vYDtbBnGT'};
    var a2 = {address: 'jJwkfLEVTkM6u3J7kWoATFd5aauBw5S8Kz', secret: 'ssLHnWZyTuoWaJ7MoF2BoiKGtJbSy'};

    //设置签名列表
/*    var req = remote.buildSignerListTx({
        account: root.address,
        threshold: 3,
        lists: [{
            account: a1.address,
            weight: 2
        },
            {account: a2.address,
            weight: 2},
            {
                account: a3.address,
                weight:2
            }
            ]
    });
    req.setSecret(root.secret);*/

    //首个用户签名
    var req = remote.buildPaymentTx({account: root.address, to: a1.address, amount: {
        "value": "2",
        "currency": "SWT",
        "issuer": ""
    }});
    remote.buildSignFirstTx(req);
    req.setSignAccount(a1.address);
    req.setSignSecret(a1.secret);
    req.setSequence(7);
    console.log('req: ', req.tx_json);
    /* 返回结果
    * { tx_blob: '120000220000000024000000816140000000001E848068400000000000271073008114B5F762798A53D543A014CAF8B297CFF8F2F937E88314577F22BBCFC872325BB006322692FDC60AE33890F9EA7D0AE694AFE4BB9832535754E1F1FAEB732103B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF7446304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF9708114577F22BBCFC872325BB006322692FDC60AE33890E1F1',
    tx_json:
    { Account: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
    Amount: '2000000',
    Destination: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
    Fee: '10000',
    Flags: 0,
    Memos: [ { Memo: { MemoData: 'E694AFE4BB9832535754' } } ],
    Sequence: 129,
    Signers: [ { Signer:
    { Account: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
    SigningPubKey: '03B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF',
    TxnSignature: '304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF970' } } ],
    SigningPubKey: '',
    TransactionType: 'Payment',
    hash: '52A30A8AF1177F3674BB44C05FB244B62472F3BE32E72081EAEB4E0FBBA89838' } }
    *
    * */

    //其他用户签名
    var tx_json = { Account: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
        Amount: '2000000',
        Destination: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
        Fee: '10000',
        Flags: 0,
        Memos: [ { Memo: { MemoData: 'E694AFE4BB9832535754' } } ],
        Sequence: 129,
        Signers: [ { Signer:
            { Account: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
                SigningPubKey: '03B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF',
                TxnSignature: '304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF970' } } ],
        SigningPubKey: '',
        TransactionType: 'Payment',
        hash: '52A30A8AF1177F3674BB44C05FB244B62472F3BE32E72081EAEB4E0FBBA89838' };
    // var req = remote.buildSignOtherTx( {account: a2.address, secret:a2.secret, tx_json: tx_json});
    /*返回结果
    * { tx_blob: '120000220000000024000000816140000000001E848068400000000000271073008114B5F762798A53D543A014CAF8B297CFF8F2F937E88314577F22BBCFC872325BB006322692FDC60AE33890F9EA7D0AE694AFE4BB9832535754E1F1FAEB732103B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF7446304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF9708114577F22BBCFC872325BB006322692FDC60AE33890E1EB732103F54EA6509AD28E8E9AE8762B07CD245B5AB87DC840723DBF6C4C0A621A42B4A17446304402201C3FEE8EB701D761B7006A208BCD342C344A0AF6E040FAA7A8D2A5B898B2EE1D022068BE613AB4EFC909D9ACC04D8AD4465025969708FCFCCE924DB77535075706BB8114BC51DE21D4591EBF30812B1071C5E1AABBA07DE4E1F1',
      tx_json:
       { Account: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
         Amount: '2000000',
         Destination: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
         Fee: '10000',
         Flags: 0,
         Memos: [ { Memo: { MemoData: 'E694AFE4BB9832535754' } } ],
         Sequence: 129,
         Signers: [ { Signer:
         { Account: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
           SigningPubKey: '03B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF',
           TxnSignature: '304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF970' } },
      { Signer:
         { Account: 'jJwkfLEVTkM6u3J7kWoATFd5aauBw5S8Kz',
           SigningPubKey: '03F54EA6509AD28E8E9AE8762B07CD245B5AB87DC840723DBF6C4C0A621A42B4A1',
           TxnSignature: '304402201C3FEE8EB701D761B7006A208BCD342C344A0AF6E040FAA7A8D2A5B898B2EE1D022068BE613AB4EFC909D9ACC04D8AD4465025969708FCFCCE924DB77535075706BB' } } ],
         SigningPubKey: '',
         TransactionType: 'Payment',
         hash: '57AA10D3486A7679B9504E4E799E342966EB80E4EC509CC160430BB3AA0955E6' } }
    * */


    // 提交多重签名
    var tx_json2 =  { Account: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
        Amount: '2000000',
        Destination: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
        Fee: '10000',
        Flags: 0,
        Memos: [ { Memo: { MemoData: 'E694AFE4BB9832535754' } } ],
        Sequence: 129,
        Signers: [ { Signer:
            { Account: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
                SigningPubKey: '03B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF',
                TxnSignature: '304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF970' } },
            { Signer:
                { Account: 'jJwkfLEVTkM6u3J7kWoATFd5aauBw5S8Kz',
                    SigningPubKey: '03F54EA6509AD28E8E9AE8762B07CD245B5AB87DC840723DBF6C4C0A621A42B4A1',
                    TxnSignature: '304402201C3FEE8EB701D761B7006A208BCD342C344A0AF6E040FAA7A8D2A5B898B2EE1D022068BE613AB4EFC909D9ACC04D8AD4465025969708FCFCCE924DB77535075706BB' } } ],
        SigningPubKey: '',
        TransactionType: 'Payment',
        hash: '57AA10D3486A7679B9504E4E799E342966EB80E4EC509CC160430BB3AA0955E6' } ;
    // var req = remote.buildMultisignedTx(tx_json2);

    //var req = remote.requestTx({hash:'57AA10D3486A7679B9504E4E799E342966EB80E4EC509CC160430BB3AA0955E6'});//多重签名交易
    /*返回结果
    * { engine_result: 'tesSUCCESS',
      engine_result_code: 0,
      engine_result_message: 'The transaction was applied. Only final in a validated ledger.',
      tx_blob: '120000220000000024000000816140000000001E848068400000000000271073008114B5F762798A53D543A014CAF8B297CFF8F2F937E88314577F22BBCFC872325BB006322692FDC60AE33890F9EA7D0AE694AFE4BB9832535754E1F1FAEB732103B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF7446304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF9708114577F22BBCFC872325BB006322692FDC60AE33890E1EB732103F54EA6509AD28E8E9AE8762B07CD245B5AB87DC840723DBF6C4C0A621A42B4A17446304402201C3FEE8EB701D761B7006A208BCD342C344A0AF6E040FAA7A8D2A5B898B2EE1D022068BE613AB4EFC909D9ACC04D8AD4465025969708FCFCCE924DB77535075706BB8114BC51DE21D4591EBF30812B1071C5E1AABBA07DE4E1F1',
      tx_json:
       { Account: 'jHb9CJAWyB4jr91VRWn96DkukG4bwdtyTh',
         Amount: '2000000',
         Destination: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
         Fee: '10000',
         Flags: 0,
         Memos: [ { Memo: { MemoData: 'E694AFE4BB9832535754' } } ],
         Sequence: 129,
         Signers: [
         { Signer:
            { Account: 'j3yeaNQUqMmrDb1T1p6Q2qHm9BHaAAmSwb',
               SigningPubKey: '03B61B9644843F1781F66D72C99840AD7BE4FAC713EF5AC73F30278B2287B7BBFF',
               TxnSignature: '304402207876245EF688298CCAF17343FE84EB3891E21994E11E79C18DD1226B071747060220343E2FC499E99EC7DAA375E37E43F4C4AA6AE1D517D7D0E197167312591EF970' } },
         { Signer:
            { Account: 'jJwkfLEVTkM6u3J7kWoATFd5aauBw5S8Kz',
              SigningPubKey: '03F54EA6509AD28E8E9AE8762B07CD245B5AB87DC840723DBF6C4C0A621A42B4A1',
              TxnSignature: '304402201C3FEE8EB701D761B7006A208BCD342C344A0AF6E040FAA7A8D2A5B898B2EE1D022068BE613AB4EFC909D9ACC04D8AD4465025969708FCFCCE924DB77535075706BB' } } ],
         SigningPubKey: '',
         TransactionType: 'Payment',
         hash: '57AA10D3486A7679B9504E4E799E342966EB80E4EC509CC160430BB3AA0955E6' } }
    * */

   //  tx.submit(function (err, result) {
   //      if(err) console.log('err: ', err);
   //      console.log('result: ', result);
   //      // console.log(utils.processTx(result, result.Account));
   //      // console.log('result: ', result.tx_json.Signers);
   //  })
// });
